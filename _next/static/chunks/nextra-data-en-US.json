{"/for_konsumenter":{"title":"For konsumenter","data":{"oppsett#Oppsett":"For å ta i bruk dp-iverksett må klient-applikasjonen åpne for trafikk til tjenesten. Legg inn følgende kodesnutt i deres\nnais-konfig:\naccessPolicy:\n  outbound:\n    rules:\n      - application: dp-iverksett\n        namespace: teamdagpenger\nTilsvarende må vi åpne for trafikk fra deres klient-applikasjon i dp-iverksett. Opprett en pull request i dp-iverksett med følgende kodesnutt i nais-konfig:\naccessPolicy:\n  inbound:\n    rules:\n      - application: [applikasjonsnavn]\n        namespace: [namespace]\nMerk at disse reglene legger opp til service-til-service-kommunikasjon innenfor samme kubernetes-cluster. Det vil si at\nklient-applikasjonen må bruke dp-iverksett sin service discovery-url. Bruk en av følgende URL-er:\nhttp://dp-iverksett.teamdagpenger\nhttp://dp-iverksett.teamdagpenger.svc.cluster.local\nTa kontakt med oss dersom deres klient-applikasjon må bruke ingressen for å kommunisere med dp-iverksett.","autentisering#Autentisering":"Tjenesten krever Azure token på alle kall, dvs. enten et Client Credentials-token eller et On-Behalf-Of-token.\nLes mer om autentisering i nais-dokumentasjonen.","api-dokumentasjon-og-kontrakter-for-dto-klasser#API-dokumentasjon og kontrakter for DTO-klasser":"dp-iverksett har swagger-dokumentasjon her.Vi har samlet alle DTO-ene som brukes av API-et i et bibliotek. Se dp-kontrakter på github\nog bruk pakken iverksett."}},"/for_konsumenter/avstemming":{"title":"Avstemming","data":{"post-start-grensesnittavstemming#POST /start-grensesnittavstemming":"Setter i gang grensesnittavstemming. Trenger bare å bli kalt èn gang per ytelse, så går grensesnittavstemming fullautomatisk."}},"/for_konsumenter/iverksetting":{"title":"Iverksetting","data":{"post-apiiverksetting#POST /api/iverksetting":"Sender en utbetaling til NAVs økonomisystem. Når API-et mottar en utbetaling som skal iverksettes, gjør den noen enkle valideringer\nog svarer med en 202 Accepted dersom valideringene går gjennom. Resten av løypa for å utbetale er helt asynkron og orkestreres\ninternt i dp-iverksett. En ok-respons fra API-et betyr altså ikke at utbetalingen er kvittert ok i økonomisystemet, men at\ndp-iverksett tar ansvaret for videre håndtering. Bruk status-endepunktet for å sjekke status på utbetalingen.Følgende må være oppfylt for at dp-iverksett skal akseptere utbetalingen:Format på utbetaling\nUtbetalingsperiodene må ikke overlappe i tid\nUtbetalingsperiodene må være gyldige perioder, dvs. at fom-dato på en periode må være før tom-dato.\nAlle beløp må være positive heltall. Dvs. alle beløp må være hele kroner, og tjenesten aksepterer ikke 0-utbetalinger eller negative utbetalinger\nAlle beløp må være under maksgrensen på 5000 kr/dag\nTilstand\ndp-iverksett kan ikke allerede ha en utbetaling med samme behandlingsid\nEvt. tidligere utbetaling må tilhøre samme sak og person\nEvt. tidligere utbetaling på saken må være ferdig iverksatt\nVidere er det noen ytelsesspesifikke valideringer. Ta kontakt med oss dersom din ytelse har spesielle behov.","utbetalinger#Utbetalinger":"Listen av utbetalinger som dp-iverksett tar i mot følger dette formatet:\n{\n \"beløpPerDag\": \"int\",\n \"fraOgMed\": \"date\",\n \"tilOgMed\": \"date\",\n \"stønadstype\": \"enum\"\n}\nUtbetalingene må altså periodiseres og klienten må fastsette et beløp per dag for perioden. Dersom beløpet eller stønadstypen\nendrer seg eller brukeren har dager i perioden uten utbetaling (eksempelvis helg), må det opprettes ny periode.Eksempler (kan vi få dette i en sånn toggle-greie)Bruker skal ha utbetaling mandag-fredag med 500kr/dag tom onsdag og 400kr/dag fom torsdag. Det representeres med følgende utbetalingsperioder:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-15\"\n  },\n  {\n    \"beløpPerDag\": 400,\n    \"fraOgMed\": \"2023-11-16\",\n    \"tilOgMed\": \"2023-11-17\"\n  }\n]\nBruker skal ha 500kr/dag for 14 dager, med unntak av helger. Det representeres med følgende utbetalingsperioder:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-17\"\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-20\",\n    \"tilOgMed\": \"2023-11-24\"\n  }\n]\nMerk at dp-iverksett må ha beløp per dag for meldepliktsytelser uavhengig av hvordan vedtaksløsningen representerer utbetalingene\ninternt. Dette kommer av føringer fra NAVs økonomisystem. Dersom din vedtaksløsning feks representerer utbetalingen som et\ntotalbeløp for en 14-dagers periode, må dere på konsumentsiden fordele dette totalbeløpet på dagsbeløp slik dere ser det hensiktsmessig.","tilgangskontroll-og-validering-av-vedtak#Tilgangskontroll og validering av vedtak":"Funksjonaliteten som tilbys i dp-iverksett er direkte koblet til penger som betales ut fra NAV til sluttbruker. Det kan ha store konsekvenser\ndersom vi betaler ut for mye penger eller penger til feil bruker. Derfor er vi nødt til å ha streng tilgangskontroll på vedtakene som dp-iverksett\ntar i mot.Meldepliktsytelsene har gjerne en todelt flyt der det først fattes et vedtak om rett til ytelsen, og så danner meldekortene brukeren sender inn\ngrunnlaget for hva som skal utbetales i en gitt periode. Meldekortene behandles stort sett fullautomatisk av vedtaksløsningen, mens vedtaket om\nrett kan behandles helt eller delvis manuelt.Dp-iverksett krever at konsumentene sender både vedtak om rett og utbetalingene som følger av meldekortene, med riktig kontekst. Tjenesten vil validere\nat vedtak med saksbehandler-kontekst kommer fra en ansatt med beslutter-rolle for ytelsen. Videre har dp-iverksett oversikt over hvilken klient-applikasjon som\nhar tilgang til å gjøre kall med ren system-kontekst for hver ytelse.Dersom dp-iverksett mottar en utbetaling som ikke kan spores tilbake til et vedtak om rett til ytelsen eller mottar en utbetaling fra en applikasjon\nsom ikke har tilgang til å kalle med system-kontekst, vil utbetalingen avvises.For vedtaket om rett til ytelsen trenger dp-iverksett å vite saksid, behandlingsid og sluttbrukeren vedtaket gjelder. Disse vedtakene kan sendes\ntil det samme endepunktet som utbetalingene sendes til. I kontraktene finnes det en default-verdi for vedtaksdetaljer for slike vedtak. Informasjonen\ndp-iverksett krever er eksemplifisert under:\n{\n  \"sakId\": \"ec45be1c-1f2d-451e-bea3-e5a240586287\",\n  \"behandlingId\": \"f28417ba-78bb-440b-985c-fc1f0330c1c2\",\n  \"personIdent\": \"<fnr>\",\n  \"vedtak\": {\n    \"vedtakstype\": \"RAMMEVEDTAK\",\n    \"resultat\": \"INNVILGET\",\n    \"vedtakstidspunkt\": \"2023-06-19T15:24:14\",\n    \"saksbehandlerId\": \"S123456\",\n    \"beslutterId\": \"B123456\",\n    \"utbetalinger\": []\n  }\n}"}},"/for_konsumenter/status":{"title":"Status på utbetaling","data":{"get-behandlingidstatus#GET /{behandlingId}/status":"Henter status på utbetaling. Dette endepunktet kan brukes for å sjekke tilstanden til en utbetaling som er tatt i mot og\nvalidert av dp-iverksett. NAVs økonomisystem har en asynkron integrasjon og er i tillegg et stormaskinsystem som har definerte\noppetider. Økonomisystemet er stengt mellom i helger, helligdager og mellom kl 21 og kl 6 på virkedager. Derfor kan det\nta lang tid før en utbetaling blir kvittert ut fra økonomisystemet avhengig av når den er sendt inn.Dersom dp-iverksett finner behandlingen, vil endepunktet svare med 200 OK og en av følgende statuser i body:\nStatus\tBeskrivelse\tIKKE_PAABEGYNT\tIkke sendt til økonomisystemet\tSENDT_TIL_OPPDRAG\tSendt til økonomisystemet, venter på svar\tFEILET_MOT_OPPDRAG\tFeilkvittering fra økonomisystemet. Kan være enten teknisk eller funksjonell feil.\tOK\tKvittert OK fra økonomisystemet og ferdigstilt.\t\nNB! Vi har mulighet til å tilby et Kafka-topic der konsumentene kan lytte på status-oppdateringer på utbetalinger. Dette er p.t.\nikke satt opp, men vi bruker gjerne tid på det dersom behovet er der. Ta kontakt med oss dersom dette høres interessant ut\nfor dere."}},"/":{"title":"Om tjenesten","data":{"":"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","seksjon-1#Seksjon 1":"","seksjon-2#Seksjon 2":"","seksjon-3#Seksjon 3":""}},"/utvikling":{"title":"Utvikling","data":{}}}