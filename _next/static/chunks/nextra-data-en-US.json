{"/for_konsumenter/avstemming":{"title":"Avstemming","data":{"":"Utsjekk håndterer grensesnittavstemming mot Økonomisystemet internt. Konsumenter trenger ikke å foreta seg noe for at grensesnittavstemming skal\nsettes i gang og gå jevnlig.Ta kontakt med oss dersom dere har behov for annen type avstemming mot Økonomisystemet eller mellom vedtaksløsningen og Utsjekk."}},"/for_konsumenter":{"title":"For konsumenter","data":{"oppsett#Oppsett":"For å ta i bruk utsjekk må klient-applikasjonen åpne for trafikk til tjenesten. Legg inn følgende kodesnutt i deres\nnais-konfig:\naccessPolicy:\n  outbound:\n    rules:\n      - application: utsjekk\n        namespace: helved\nTilsvarende må vi åpne for trafikk fra deres klient-applikasjon i utsjekk. Opprett en pull request i utsjekk med følgende kodesnutt i nais-konfig:\naccessPolicy:\n  inbound:\n    rules:\n      - application: [applikasjonsnavn]\n        namespace: [namespace]\nMerk at disse reglene legger opp til service-til-service-kommunikasjon innenfor samme kubernetes-cluster. Det vil si at\nklient-applikasjonen må bruke utsjekk sin service discovery-url. Bruk en av følgende URL-er:\nhttp://utsjekk.helved\nhttp://utsjekk.helved.svc.cluster.local\nTa kontakt med oss dersom deres klient-applikasjon må bruke ingressen for å kommunisere med utsjekk.","autentisering#Autentisering":"Tjenesten krever Azure token på alle kall, dvs. enten et Client Credentials-token eller et On-Behalf-Of-token.\nLes mer om autentisering i nais-dokumentasjonen.","api-dokumentasjon-og-kontrakter-for-dto-klasser#API-dokumentasjon og kontrakter for DTO-klasser":"utsjekk har swagger-dokumentasjon her.Vi har samlet alle DTO-ene som brukes av API-et i et bibliotek. Se utsjekk-kontrakter på github\nog bruk pakken iverksett."}},"/for_konsumenter/iverksetting":{"title":"Iverksetting","data":{"post-apiiverksetting#POST /api/iverksetting":"Sender en utbetaling til NAVs økonomisystem. Når API-et mottar en utbetaling som skal iverksettes, gjør den noen enkle valideringer\nog svarer med en 202 Accepted dersom valideringene går gjennom. Resten av løypa for å utbetale er helt asynkron og orkestreres\ninternt i Utsjekk. En ok-respons fra API-et betyr altså ikke at utbetalingen er kvittert ok i økonomisystemet, men at\nUtsjekk tar ansvaret for videre håndtering. Bruk status-endepunktet for å sjekke status på utbetalingen.","validering#Validering":"Følgende må være oppfylt for at Utsjekk skal akseptere utbetalingen:Format på utbetaling\nUtbetalingsperiodene må ikke overlappe i tid innenfor samme stønadsundergruppe.\nUtbetalingsperiodene må være gyldige perioder, dvs. at fom-dato på en periode må være før tom-dato.\nAlle beløp må være positive heltall. Dvs. alle beløp må være hele kroner, og tjenesten aksepterer ikke 0-utbetalinger eller negative utbetalinger\nAlle beløp må være under maksgrensen på 5000 kr/dag*\nTilstand\nUtsjekk kan ikke allerede ha en utbetaling med samme behandlingsid*\nEvt. tidligere utbetaling må tilhøre samme sak\nEvt. tidligere utbetaling på saken må være ferdig iverksatt\n* Gjelder ikke tilleggsstønaderVidere er det noen ytelsesspesifikke valideringer. Ta kontakt med oss dersom din ytelse har spesielle behov.","utbetalinger#Utbetalinger":"Listen av utbetalinger som Utsjekk tar i mot følger dette formatet:\n{\n    \"beløpPerDag\": \"int\",\n    \"fraOgMed\": \"date\",\n    \"tilOgMed\": \"date\",\n    \"stønadsdata\": {\n        \"stønadstype\": \"enum\",\n        // <ekstra_felter_spesifikke_for_ytelsen>\n    }\n}\nUtbetalingene må altså periodiseres og klienten må fastsette et beløp per dag for perioden. Dersom beløpet eller stønadstypen\nendrer seg eller brukeren har dager i perioden uten utbetaling (eksempelvis helg), må det opprettes ny periode.Eksempler\nEksempel 1: Endring i beløp\nBruker skal ha utbetaling mandag-fredag med 500kr/dag tom onsdag og 400kr/dag fom torsdag. Det representeres med følgende utbetalingsperioder:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-15\"\n  },\n  {\n    \"beløpPerDag\": 400,\n    \"fraOgMed\": \"2023-11-16\",\n    \"tilOgMed\": \"2023-11-17\"\n  }\n]\nEksempel 2: Utbetaling med samme beløp for en 14-dagers periode\nBruker skal ha 500kr/dag for 14 dager, med unntak av helger. Det representeres med følgende utbetalingsperioder:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-17\"\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-20\",\n    \"tilOgMed\": \"2023-11-24\"\n  }\n]\nMerk at Utsjekk må ha beløp per dag for meldepliktsytelser uavhengig av hvordan vedtaksløsningen representerer utbetalingene\ninternt. Dette kommer av føringer fra NAVs økonomisystem. Dersom din vedtaksløsning feks. representerer utbetalingen som et\ntotalbeløp for en 14-dagers periode, må dere på konsumentsiden fordele dette totalbeløpet på dagsbeløp slik dere ser det hensiktsmessig.","gjeldende-totalbilde-av-utbetalinger-på-saken#Gjeldende totalbilde av utbetalinger på saken":"Listen av utbetalinger som Utsjekk tar i mot skal være det gjeldende totalbildet av utbetalinger for hele saken. Utsjekk håndterer utbetalingene\npå samme måte uavhengig av om vedtaket som iverksettes er en førstegangsutbetaling eller en korrigering: Når Utsjekk beregner hva som skal sendes\ntil utbetalingssystemet, regner den ut forskjellen på totalbildet for det nye vedtaket og totalbildet for det evt. forrige vedtaket som ble iverksatt.Konseptet er illustrert i figuren under for 3 meldekort, der ett meldekort korrigeres (klikk for å åpne i ny fane):\nI denne figuren er D en dag med utbetaling og H er en helgedag uten utbetaling. Rosa farge indikerer en dag med korrigert utbetaling.Under er et eksempel på hvordan dataen for dette totalbildet kan se ut for 7 meldekort som sendes inn og korrigeres (klikk for å åpne i ny fane):\nI det første meldekortet som sendes inn (B-2) er det gjeldende totalbildet utbetaling for uke 1 og 2. For det neste meldekortet som sendes inn (B-3)\ner det gjeldende totalbildet utbetaling for uke 1 og 2 og uke 3 og 4. Dersom vedtaksløsningen vil iverksette en korrigering av utbetalingen for uke 1 og 2 (B-4),\nsender den inn den nye sannheten for uke 1 og 2 og uendret utbetaling for uke 3 og 4. Her er det tre ting å merke seg:\nVed en korrigering skal Utsjekk alltid ha ny gjeldende sannhet, ikke differansen mellom ny og forrige utbetaling.\nUtsjekk vil ikke agere på noe dersom totalbildet er uendret. Hvis totalbildet for deler av utbetalingen er uendret, som uke 3 og 4 over,\nvil det ikke skje noe med denne perioden. Hvis totalbildet for hele saken er uendret, vil ikke Utsjekk sende noe til utbetalingssystemet.\nDersom det har vært utbetaling på saken tidligere, må Utsjekk ha behandlingsid for den forrige behandlingen som ble iverksatt. Behandlingsid-en brukes til å hente ut\ndet forrige totalbildet av utbetalinger på saken, slik at Utsjekk kan utlede om den nye behandlingen er utbetaling for en ny periode eller om det er en korrigering\n(og i så fall hva som skal korrigeres).\nMerk også at korrigeringen av utbetalingen for uke 5-6 (B-6) er et opphør. Ved opphør av utbetaling forventer Utsjekk at det ikke finnes noen utbetalinger\nfor perioden opphøret gjelder for. I dette eksempelet er altså alle utbetalingene for uke 5-6 fjernet fra listen. Dersom man vil iverksette et opphør av alle utbetalinger på saken,\nkan man sende en tom liste av utbetalinger til Utsjekk.","periodisering-av-utbetalinger#Periodisering av utbetalinger":"Utbetalingsperiodene som sendes til utbetalingstjenesten vil bli sendt videre til Økonomisystemet med samme periodisering som utbetalingstjenesten mottar. Økonomisystemet/PO Utbetaling\nhar et ønske om å minimere antall identiske utbetalingsperioder som sendes. Dette illustreres best ved et eksempel. Dersom man vil iverksette en utbetaling for mandag-fredag med likt dagsbeløp og stønadstype,\ner det bedre å sende dette som én periode:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-12\",\n    \"tilOgMed\": \"2024-02-16\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  }\n]\nHeller enn å sende 5 identiske perioder:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-12\",\n    \"tilOgMed\": \"2024-02-12\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-13\",\n    \"tilOgMed\": \"2024-02-13\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-14\",\n    \"tilOgMed\": \"2024-02-14\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-15\",\n    \"tilOgMed\": \"2024-02-15\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-16\",\n    \"tilOgMed\": \"2024-02-16\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  }\n]\nUtbetalingsperioder som sendes på tvers av behandlinger må imidlertid deles opp selv om de er like og ligger back-to-back i tid. Eksempelvis:Dersom man i behandling #1 iverksetter følgende utbetalingsperiode:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-12\",\n    \"tilOgMed\": \"2024-02-16\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  }\n]\nOg man i behandling #2 vil iverksette flere dager med utbetaling, må dette deles i to:\n[\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-12\",\n    \"tilOgMed\": \"2024-02-16\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  },\n  {\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2024-02-17\",\n    \"tilOgMed\": \"2024-02-23\",\n    \"stønadsdata\": {\n      \"stønadstype\": \"DAGPENGER_ARBEIDSSØKER_ORDINÆR\"\n    }\n  }\n]\nDersom disse utbetalingene hadde blitt slått sammen til én periode, vil vi ikke klare å utlede hva som er differansen fra totalbildet i forrige utbetaling."}},"/for_konsumenter/iverksetting/FAQ":{"title":"FAQ","data":{"når-må-jeg-dele-opp-utbetalingen-i-flere-perioder#Når må jeg dele opp utbetalingen i flere perioder?":"Dersom beløpet eller stønadstypen\nendrer seg eller brukeren har dager i perioden uten utbetaling (eksempelvis helg), må det opprettes ny periode.Eksempler\nEksempel 1: Endring i beløp\nBruker skal ha utbetaling mandag-fredag med 500kr/dag tom onsdag og 400kr/dag fom torsdag. Det representeres med følgende utbetalingsperioder:\n[\n{\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-15\"\n},\n{\n    \"beløpPerDag\": 400,\n    \"fraOgMed\": \"2023-11-16\",\n    \"tilOgMed\": \"2023-11-17\"\n}\n]\nEksempel 2: Utbetaling med samme beløp for en 14-dagers periode\nBruker skal ha 500kr/dag for 14 dager, med unntak av helger. Det representeres med følgende utbetalingsperioder:\n[\n{\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-13\",\n    \"tilOgMed\": \"2023-11-17\"\n},\n{\n    \"beløpPerDag\": 500,\n    \"fraOgMed\": \"2023-11-20\",\n    \"tilOgMed\": \"2023-11-24\"\n}\n]","kan-jeg-sende-total-brutto-utbetaling-for-hele-meldepliktsperioden#Kan jeg sende total brutto utbetaling for hele meldepliktsperioden?":"Utsjekk må ha beløp per dag for meldepliktsytelser uavhengig av hvordan vedtaksløsningen representerer utbetalingene\ninternt. Dette kommer av føringer fra NAVs økonomisystem. Dersom din vedtaksløsning feks. representerer utbetalingen som et\ntotalbeløp for en 14-dagers periode, må dere på konsumentsiden fordele dette totalbeløpet på dagsbeløp slik dere ser det hensiktsmessig."}},"/for_konsumenter/status":{"title":"Status på utbetaling","data":{"":"Status på utbetalinger er en av følgende verdier:\nStatus\tBeskrivelse\tIKKE_PÅBEGYNT\tIkke sendt til økonomisystemet\tSENDT_TIL_OPPDRAG\tSendt til økonomisystemet, venter på svar\tFEILET_MOT_OPPDRAG\tFeilkvittering fra økonomisystemet. Kan være enten teknisk eller funksjonell feil.\tOK\tKvittert OK fra økonomisystemet og ferdigstilt.\tOK_UTEN_UTBETALING\tFerdigstilt uten å ha blitt sendt til økonomisystemet pga. at det ikke er noe å utbetale","med-rest#Med REST":"","get-behandlingidstatus#GET /{behandlingId}/status":"Henter status på utbetaling. Dette endepunktet kan brukes for å sjekke tilstanden til en utbetaling som er tatt i mot og\nvalidert av utsjekk. NAVs økonomisystem har en asynkron integrasjon og er i tillegg et stormaskinsystem som har definerte\noppetider. Økonomisystemet er vanligvis stengt i helger, helligdager og mellom kl 21 og kl 6 på virkedager. Derfor kan det\nta lang tid før en utbetaling blir kvittert ut fra økonomisystemet avhengig av når den er sendt inn.Dersom utsjekk finner behandlingen, vil endepunktet svare med 200 OK og utbetalingsstatus.","med-kafka#Med Kafka":"Vi har satt opp en topic hvor vi tilbyr statusendringer på utbetalinger: helved.iverksetting-status-v1. Om dette\ner interessant for dere kan dere kontakte oss så vi får gitt appen deres tilgang til topicen. I tillegg må følgende finnes\ni nais-konfigen deres:\nspec:\n  kafka:\n    pool: nav-prod # Eller nav-dev for dev-miljø\nMeldinger som publiseres her bruker personident som nøkkel og har følgende format på meldingen:\ndata class StatusEndretMelding(\n    val sakId: String,\n    val behandlingId: String,\n    val iverksettingId: String?,\n    val fagsystem: Fagsystem,\n    val status: IverksettStatus,\n)\nDataklassen finner du i utsjekk-kontrakter om du ønsker å bruke den direkte."}},"/":{"title":"Om tjenesten","data":{"":"Utsjekk tilbyr tjenester innenfor utbetalingsdomenet for arbeidsytelser. Mer spesifikt kan den sende og korrigere utbetalinger, avstemme utbetalinger og gi oppdatert status på tilstanden til en utbetaling.\nSe individuelle sider for dokumentasjon av hver tjeneste.Hensikten med denne siden er å dokumentere konsepter og funksjonelle aspekter ved Utsjekk sine tjenester som ikke kommer tydelig frem i API-dokumentasjonen. Er du ute etter tekniske detaljer rundt endepunktene, se Swagger-dokumentasjonen\nher (krever naisdevice). Videre finnes det kontrakter for alle DTO-er som Utsjekk bruker i sitt API her.\nDe aktuelle kontraktene for iverksetting ligger i artifaktet iverksett. Vi oppfordrer alle konsumenter til å ta i bruk kontraktene.","kontakt#Kontakt":"Utsjekk eies av Team Hel Ved. Vi kan kontaktes på Slack i kanalen #team-hel-ved.","intern-arkitektur#Intern arkitektur":""}},"/utvikling/feature_toggles":{"title":"Feature Toggles","data":{"":"Vi bruker Unleash for å støtte feature toggles i utsjekk. Kontrollpanel kan nås via naisdevice og finnes her","stoppe-iverksetting#Stoppe iverksetting":"Vi har opprettet kill switch-toggles per fagsystem for å\nenkelt kunne stanse iverksetting av nye utbetalinger om det skulle bli behov for det. Når togglen er skrudd på er\niverksetting av utbetalinger for gitt fagsystem stanset i gitt miljø (dev/prod).\nutsjekk.stopp-iverksetting-dagpenger\nutsjekk.stopp-iverksetting-tilleggsstonader\nutsjekk.stopp-iverksetting-tiltakspenger"}}}